{"componentChunkName":"component---src-templates-blog-post-index-tsx","path":"/2023/06/24/lecture-react-season2-part2-ch1","result":{"data":{"site":{"siteMetadata":{"title":"김정환 블로그","url":"https://jeonghwan-kim.github.io"}},"markdownRemark":{"id":"d8402e6b-417a-516a-a6b3-07331c7a43c4","html":"<p>2편은 컨택스트, 고차 컴포넌트 등 리액트 고급 주제를 다룬다. 이를 활용해 라우터, 다이얼로그를 만들며 실습 어플리케이션의 나머지 요구사항을 구현해 나갈 것이다.</p>\n<p>이 장에서는 컴포넌트 구성의 한계를 짚은 뒤 리액트 컨택스트가 어떻게 해결할 수 있는지 알아 본다. 컨택스트를 직접 만들면서 내부 구조를 이해한다.</p>\n<h1 id=\"한계\" style=\"position:relative;\"><a href=\"#%ED%95%9C%EA%B3%84\" aria-label=\"한계 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>한계</h1>\n<p>컴포넌트 계층 구조에서 부모-자식은 인자를 전달해 서로 협력한다. 컴포넌트끼리 접촉해 있어야만 이메세지를 전달하수 있는 구조다. 떨어져 있으면 메세지를 전달할 수 없다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">A</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">B</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">C</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>컴포넌트 A와 B는 접해 있어 인자를 전달할 수 있다. B, C도 마찬가지. 반면 A, C는 떨어져 있어서 메세지를 직접 전달할 수 없다. B가 중간에 받아서 전달해 주어야 하는 구조다. 이것을 프롭 드릴링 현상이라고 한다.</p>\n<p>프롭 드릴링의 문제</p>\n<ul>\n<li>값의 출처 파악 어려움. 컴포넌트가 깊이 중첩 될수록 더</li>\n<li>B는 A와 C 사이에 위치했다는 이유만으로 고유의 역할과 무관하게 메세지를 전달</li>\n</ul>\n<p>예제에도 이런 모습을 예상할 수 있다. 장바구니 화면의 컴포넌트 트리는 이렇다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CartPage</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Page</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Title</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ProductItem</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">OrderForm</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FormControl</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PaymentButton</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>가령 App에 어플리케이션 테마를 관리하는 상태가 정의되어 있다고 하자. 라이트모드와 다크모드. 이 상태에 따라 버튼 색상이 다를 것이다.</p>\n<p>Button은 트리의 맨 마지막에 위치하기 때문에 App의 테마 값을 받으려면 중간에 위치한 컴포넌트들을 통해 전달 받는다. CartPage나 Page는 관심사가 아니지만 자식인 Button이 사용하기 때문에 테마 전달자 역할을 한다.</p>\n<p>App의 테마값을 Button 직접 알릴 방법은 없을까? 상위 컴포넌트의 상태가 변할 때 마다 관심있는 하위 컴포넌트에게 직접 알려줄 수 있으면 좋겠다. 중간에 관심사가 다른 컴포넌트에게 부탁할 필요도 없기 때문이다.</p>\n<h1 id=\"이벤트-에미터\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EC%97%90%EB%AF%B8%ED%84%B0\" aria-label=\"이벤트 에미터 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>이벤트 에미터</h1>\n<p>App을 발신자, Button을 수신자라고 생각해 보자. 발신자가 수신자에게 메세지(테마값)를 전달해야하는 문제다. 이를 해결할 수 있는 패턴이 이벤트 에미터(Event emitter)이다.</p>\n<p>두 객체 간의 메세지를 비교적 자유롭게 주고 받을 수 있는 통로 역할이다. 수신자가 특정 이벤트를 구독하면 발신자는 이 통로를 통해 이벤트를 보낼수 있다. 컴포넌트 간에 전달할 메세지를 이벤트 에미터에게 전달하면 구독하고 있는 컴포넌트는 이 메세지를 받을 수 있을 것이다.</p>\n<p>인터페이스다.</p>\n<ul>\n<li>on(handler): 이벤트 핸들러 등록</li>\n<li>off(handler): 이벤트 핸들러 해지</li>\n<li>get: 객체가 가진 값을 조회</li>\n<li>set: 값을 설정한 뒤 각 구독 객체에게 통지</li>\n</ul>\n<p>shared/lib/EventEmitter.js 파일을 추가하고 이벤트 에미터 생성함수를 만들어 보자. 3편에서도 사용하기 위해 shared 폴더에 추가한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">createEventEmitter</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">value</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> handlers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">on</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">handler</span> <span class=\"token operator\">=></span> handlers<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>handler<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">off</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">handler</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    handlers <span class=\"token operator\">=</span> handlers<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">h</span> <span class=\"token operator\">=></span> h <span class=\"token operator\">!==</span> handler<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">get</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> value\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">set</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">newValue</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    value <span class=\"token operator\">=</span> newValue\n    handlers<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">handler</span> <span class=\"token operator\">=></span> <span class=\"token function\">handler</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    on<span class=\"token punctuation\">,</span>\n    off<span class=\"token punctuation\">,</span>\n    get<span class=\"token punctuation\">,</span>\n    set<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이벤트 에미터가 전달할 메세지 value를 인자로 받았다. on은 이 값의 변경을 구독할 수 있는데 핸들러를 등록하고 off는 핸들러를 제거해 구독 해지한다. get은 메세지를 조회하고 set은 새로운 메세지를 받아 저장하고 구독자들에게 알린다.</p>\n<p>사용해 보면 구조 이해하는데 도움이 될 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> eventEmitter <span class=\"token operator\">=</span> <span class=\"token function\">createEventEmitter</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">logger</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">value</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span>\neventEmitter<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span>logger<span class=\"token punctuation\">)</span>\neventEmitter<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 0</span>\neventEmitter<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 1</span>\neventEmitter<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 2</span>\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> eventEmitter<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// (1초 후에) 3</span></code></pre></div>\n<p>초기값 0으로 만든 이벤트 에미터 객체를 만들고 logger가 이를 구독했다. 현재 값을 조회하면 0이고 set 함수를 호출할 때마다 logger에게 알릴 것이다. 중요한 것은 1초 후에 set 함수를 호출해도 여전히 값을 로깅하는데 logger가 이벤트 에미터를 구독하고 있기 때문이다.</p>\n<p>logger가 이벤트 에미터를 구독한 것처럼 컴포넌트가 구독할 무언가를 만들어 보자.</p>\n<h1 id=\"컨택스트\" style=\"position:relative;\"><a href=\"#%EC%BB%A8%ED%83%9D%EC%8A%A4%ED%8A%B8\" aria-label=\"컨택스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>컨택스트</h1>\n<p>컴포넌트가 구독할 대상을 컨택스트라고 부르자. 컨택스트를 만드는 createContext라는 함수를 만들겠다. src/lib/MyReact.js 파일을 만든다.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> MyReact <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">function</span> <span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">initialValue</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> emitter <span class=\"token operator\">=</span> <span class=\"token function\">createEventEmitter</span><span class=\"token punctuation\">(</span>initialValue<span class=\"token punctuation\">)</span>\n\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Provider</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> value<span class=\"token punctuation\">,</span> children <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span></span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Consumer</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> children <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token function\">children</span><span class=\"token punctuation\">(</span>emitter<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span></span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      Provider<span class=\"token punctuation\">,</span>\n      Consumer<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    createContext<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>createContext는 컨택스트 초기 값을 인자로 받아 컨택스트 객체를 만드는 함수다. 이 인자로 이벤트 에미터를 만들었다.</p>\n<p>공급자(Provider)와 소비자(Consumer) 컴포넌트를 만들었는데 이벤트 에미터를 통해 메세지를 공급하고 소비하는 컴포넌트다. 실제 구현은 좀 나중으로 미뤘다.</p>\n<p>컨택스트를 사용해 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> countContext <span class=\"token operator\">=</span> MyReact<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">setCount</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>카운트 컨택스트를 만들었다. 카운트 값과 세터가 기본 값이다.</p>\n<p>컨택스트에게 메세지를 전달할 카운터 제공자 컴포넌트를 만들자.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CountProvider</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> value <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token function-variable function\">setCount</span><span class=\"token operator\">:</span> <span class=\"token parameter\">nextValue</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> nextValue <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span>countContext<span class=\"token punctuation\">.</span>Provider value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>countContext<span class=\"token punctuation\">.</span>Provider<span class=\"token operator\">></span></span>    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>초기값 0인 상태 count를 추가했다. 이 값을 컨택스트로 전달할 것이다.</p>\n<p>렌더 메소드에서는 이 값과 세터함수로 이뤄진 value를 만들었다. 카운터 컨택스트의 초기값과 같은 인터페이스다. 렌더 메소드는 카운터 컨택스트의 제공자 컴포넌트를 반환하는데 value를 전달했다. 나머지 자식 컴포넌트는 프로바이더 안에서 렌더링될 것이다.</p>\n<p>CountProvider를 사용하면 하위의 컴포넌트는 카운터 컨택스트를 통해서 제공자의 value를 언제라도 사용할 수 있다.</p>\n<p>카운터 값을 표시하는 Count를 만들어 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Count</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>countContext.Consumer</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token punctuation\">{</span><span class=\"token parameter\">value</span> <span class=\"token operator\">=></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>countContext.Consumer</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>카운터 컨택스트의 소비자 컴포넌트를 사용했다. children 인자가 렌더 프롭이기 때문에 리액트 앨리먼트를 반환하는 함수 형태로 자식 컴포넌트를 정의했다. 소비자는 제공자가 컨택스트를 통해 전달한 값을 value 인자로 제공 받을 수 있다. 그 값 중 카운트를 표시한 것이다.</p>\n<p>카운터를 올리는 버튼을 만들어 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">PlusButton</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>countContext.Consumer</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> count<span class=\"token punctuation\">,</span> setCount <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">+ 카운트 올리기</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>countContext.Consumer</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>소비자 컴포넌트를 사용하고 리액트 앨리먼트를 반환하는 함수를 자식으로 정의했다. 컨택스트를 통해 value 인자를 받는데 여기서는 setCount 함수를 호출해 카운트 값을 하나 올렸다.</p>\n<p>카운트 컨택스트를 통해 전달된 setCount 함수가 호출되면 이를 제공하는 CountProvidoer의 setState가 호출된다. 공급자 컴포넌트의 상태가 변경되기 때문에 하위 컴포넌트는 다시 렌더될 것이다. 그 중 Count는 갱신된 count를 받아 리액트 앨리먼트를 그릴 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CountProvider</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Count</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PlusButton</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">CountProvider</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>컨택스트를 이용한 컴포넌트 트리는 이런 모습이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CountProvider</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Provider</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Count</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Consumer</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PlusButton</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Consumer</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>컴포넌트 간에는 아무런 메세지도 직접 전달하지 않는다. CountProvider 메세지를 제공하고 Count와 PlusButton는 이 메세지를 사용할 것이다.</p>\n<p>아직 동작하지는 않는다. Provider가 컨택스트 값을 제공하지 않기 때문이다. CounterProvider가 Provider에게 value를 전달하지만 MyReact의 Provider는 아무 일도 하지 않는다. 이 값이 바뀔 경우 리액트 컴포넌트를 리렌더해야하는 과제가 남았다. 컨택스트 값의 변화를 이벤트 에미터가 전달해 Consumer가 인지하고 리렌더링 하도록 해야한다.</p>\n<h1 id=\"공급자와-소비자\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B8%89%EC%9E%90%EC%99%80-%EC%86%8C%EB%B9%84%EC%9E%90\" aria-label=\"공급자와 소비자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공급자와 소비자</h1>\n<p>컴포넌트가 리렌더링되려면 컴포넌트 상태나 인자가 변경 되어야 한다.</p>\n<p>Provider와 Consumer를 다시 살펴보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Provider</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> value<span class=\"token punctuation\">,</span> children <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Consumer</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> children <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token function\">children</span><span class=\"token punctuation\">(</span>emitter<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>이벤트 에미터에서 값을 가져오기만했지 값의 변화를 전파하지는 않았다. 이 값이 리액트 상태로 관리되고 이벤트 에미터가 관리하는 값의 변화를 이 상태와 동기화 해야할 것이다.</p>\n<p>Provider를 변경하자.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Provider</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    emitter<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    emitter<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>컴포넌트가 마운트되거나 value가 바뀌어 컴포넌트를 업데이트 때마다 이를 이벤트 에미터에게 알린다. 메세지를 받은 이벤트 에미터는 내부 value를 새로운 메세지로 바꾼뒤 핸들러 함수를 모두 실행해 구독하고 있는 객체들에게 이 값을 알릴 것이다.</p>\n<p>Consumer는 이렇게 바꾸자.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Consumer</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> emitter<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span>    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>setValue <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextValue</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> nextValue <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    emitter<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>setValue<span class=\"token punctuation\">)</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    emitter<span class=\"token punctuation\">.</span><span class=\"token function\">off</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>setValue<span class=\"token punctuation\">)</span></span>  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">children</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Consumer는 내부 상태 value를 두어 이벤트 에미터가 전달한 값을 저장했다. 메소드 setValue는 값을 받아 상태를 갱신하는데 컴포넌트가 마운트될 때 이벤트 에미터의 구독 함수로 전달했다. 컴포넌트가 언마운트될때 이 함수는 이벤트 에미터에서 제거될 것이다.</p>\n<p>Consumer는 렌더 프롭을 인자로 받기 때문에 children이 함수 형태로 전달 될 것이다. 이 함수 인자로 이벤트 에미터가 가진 상태 값을 저장해둔 value를 전달한다.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3f7521afafaeadd4a8d1eaa0aed91793/066f9/context-working.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 177.47252747252747%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAjABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB2qCQUCQUCQf/xAAXEAEBAQEAAAAAAAAAAAAAAAABEAAR/9oACAEBAAEFAuRrWtd//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwFf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwFf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQAGPwJ//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAExEP/aAAgBAQABPyFJlCmUKZQplCmUf//aAAwDAQACAAMAAAAQkAUAcA//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EF//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EF//xAAbEAACAwEBAQAAAAAAAAAAAAABMQAQcRFRIf/aAAgBAQABPxAQAjq9nB4IA4+BRGUjIjKRkRlIyIykZP/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"컨택스트가 동작한다\"\n        title=\"컨택스트가 동작한다\"\n        src=\"/static/3f7521afafaeadd4a8d1eaa0aed91793/066f9/context-working.jpg\"\n        srcset=\"/static/3f7521afafaeadd4a8d1eaa0aed91793/5fc5d/context-working.jpg 182w,\n/static/3f7521afafaeadd4a8d1eaa0aed91793/accec/context-working.jpg 363w,\n/static/3f7521afafaeadd4a8d1eaa0aed91793/066f9/context-working.jpg 400w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">컨택스트가 동작한다</figcaption>\n  </figure></p>\n<h1 id=\"활용\" style=\"position:relative;\"><a href=\"#%ED%99%9C%EC%9A%A9\" aria-label=\"활용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>활용</h1>\n<p>떨어진 두 개의 컴포넌트가 서로 메세지를 주고받을 수 있는 통로로 컨택스트를 사용할 수 있다. 두 컴포넌트는 인자를 직접 전달하지 않아도 서로 메세지를 주고 받을 수 있게 된다.</p>\n<p><a href=\"https://github.com/jamiebuilds/create-react-context\">폴리필 코드</a>를 참고해 만든 컨택스트는 내부에 이벤트 에미터를 사용한다. 컨택스트는 이벤트 에미터를 통해 데이터를 전달하는데 이 때마다 리액트 렌더 사이클을 돌리는 것이 특별하다.</p>\n<p>공급자는 인자가 변경될 때마다 이벤트 에미터에게 값을 전달할 것이다. 소비자는 마운트 시점에 이벤트 에미터를 구독하는데 공금자가 전달하는 값을 받을 수 있다. 이 때 리랜더를 위해 받을 값으로 상태를 갱신한다. 리액트는 소비자 컴포넌트를 다실 렌더링 할 것이다.</p>\n<p>이러한 컨택스트를 활용하는 방법은 뭐가 있을까?</p>\n<ul>\n<li>라우터</li>\n<li>다이얼로그</li>\n</ul>\n<p>앞으로 라우터와 다이얼로그를 만들면서 자세히 살펴볼 예정이다.</p>\n<p>멀린 떨어진 컨포넌트간에 메세지를 전달할 때 컨택스트만 있는 것은 아니다. 오히려 컨택스를 사용하기 전에 먼저 고려해볼 후보가 있다. 컴포넌트 합성, 렌더 프롭을 사용하는 것이 오히려 더 간단한 해법일 수(<a href=\"https://ko.legacy.reactjs.org/docs/context.html#before-you-use-context\">context를 사용하기 전에 고려할 것</a>) 있으니 이점을 유의하길 바란다.</p>\n<h1 id=\"중간-정리\" style=\"position:relative;\"><a href=\"#%EC%A4%91%EA%B0%84-%EC%A0%95%EB%A6%AC\" aria-label=\"중간 정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>중간 정리</h1>\n<p>컨택스트가 해결할 수 있는 문제를 이해했다.</p>\n<ul>\n<li>인접한 컴포넌트 간에만 인자를 전달할수 있는 구조적 한계</li>\n<li>중간 컴포넌트 없이 비교적 직접 전달할 수 있는 방법이 리액트 컨택스트</li>\n</ul>\n<p>createContext</p>\n<ul>\n<li>멀리 떨어진 객체 간에 메세지를 전달하기 위해 이벤트 구독 패턴을 사용</li>\n<li>이벤트 에미터와 이를 활용한 createContext을 만듬</li>\n</ul>\n<p>컨택스트를 만들고 Provider와 Consumer 컴포넌트를 사용</p>\n<ul>\n<li>Provider: 메세지 공급자. 리액트 렌더 사이클과 연동하기 위해 상태를 가짐</li>\n<li>Consumer: 이 상태를 구독할수 있는 컴포넌트. 이 값이 렌더 프롬의 함수 인자로 들어옴</li>\n<li>Provider 하위에 Consumer를 사용하기만 하면 멀리있는 컴포넌트의 메세지를 구독할 수 있음</li>\n</ul>\n<p>컨택스트는 리액트의 기본 api이다. 여기서는 배경과 구조를 이해할 목적으로 직접 구현해본 것이다. 이제부터는 리액트 api의 createContext를 사용해 볼것이다.</p>\n<p>참고</p>\n<ul>\n<li><a href=\"/dev/2021/05/05/react-context.html\">리액트 컨텍스트 | 김정환 블로그</a></li>\n<li><a href=\"https://github.com/jamiebuilds/create-react-context\">React context 폴리필 | Github</a></li>\n</ul>","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part2-ch1","date":"2023-06-24T00:02:01.000Z","title":"[리액트 2부] 2.1 컨택스트","tags":["react"],"series":"[리액트 2부] 고급주제와 훅","videoId":null,"featuredImage":null},"tableOfContents":"<ul>\n<li><a href=\"#%ED%95%9C%EA%B3%84\">한계</a></li>\n<li><a href=\"#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EC%97%90%EB%AF%B8%ED%84%B0\">이벤트 에미터</a></li>\n<li><a href=\"#%EC%BB%A8%ED%83%9D%EC%8A%A4%ED%8A%B8\">컨택스트</a></li>\n<li><a href=\"#%EA%B3%B5%EA%B8%89%EC%9E%90%EC%99%80-%EC%86%8C%EB%B9%84%EC%9E%90\">공급자와 소비자</a></li>\n<li><a href=\"#%ED%99%9C%EC%9A%A9\">활용</a></li>\n<li><a href=\"#%EC%A4%91%EA%B0%84-%EC%A0%95%EB%A6%AC\">중간 정리</a></li>\n</ul>","excerpt":"…"},"video":null,"allMarkdownRemark":{"nodes":[{"id":"a3949e40-6a8f-55c4-9a88-48a6b17cab4c","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part1","date":"2023-06-24T00:01:00.000Z","title":"[리액트 2부] 1편 리액트로 사고하기","series":"[리액트 2부] 고급주제와 훅"}},{"id":"10aeca1e-0d73-550c-814b-6ef3a174a272","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part1-ch1","date":"2023-06-24T00:01:01.000Z","title":"[리액트 2부] 1.1 준비","series":"[리액트 2부] 고급주제와 훅"}},{"id":"d103d50d-65e9-5163-a680-62363da01698","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part1-ch2","date":"2023-06-24T00:01:02.000Z","title":"[리액트 2부] 1.2 상품목록 화면","series":"[리액트 2부] 고급주제와 훅"}},{"id":"d101c79d-5138-58c6-81b1-e1c763ec85b7","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part1-ch3","date":"2023-06-24T00:01:03.000Z","title":"[리액트 2부] 1.3 주문내역 화면","series":"[리액트 2부] 고급주제와 훅"}},{"id":"40f60626-8583-5f50-9cb6-f5645101a9c6","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part1-ch4","date":"2023-06-24T00:01:04.000Z","title":"[리액트 2부] 1.4 장바구니 화면","series":"[리액트 2부] 고급주제와 훅"}},{"id":"8d1770e8-e5c2-517e-8002-e37812e72dfe","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part1-ch5","date":"2023-06-24T00:01:05.000Z","title":"[리액트 2부] 1편 최종정리","series":"[리액트 2부] 고급주제와 훅"}},{"id":"458e6b29-6d0a-5075-b688-8a8a94ccefd4","frontmatter":{"slug":"/2023/06/24/lecture-react-season2","date":"2023-06-24T00:02:00.000Z","title":"[리액트 2부] 2편 고급주제","series":"[리액트 2부] 고급주제와 훅"}},{"id":"d8402e6b-417a-516a-a6b3-07331c7a43c4","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part2-ch1","date":"2023-06-24T00:02:01.000Z","title":"[리액트 2부] 2.1 컨택스트","series":"[리액트 2부] 고급주제와 훅"}},{"id":"fd806d95-7c95-5fc3-a32b-4d1ea0cad049","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part2-ch2","date":"2023-06-24T00:02:02.000Z","title":"[리액트 2부] 2.2 라우터 1","series":"[리액트 2부] 고급주제와 훅"}},{"id":"5b02b663-8e0c-58fb-97a7-ed7018371077","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part2-ch3","date":"2023-06-24T00:02:03.000Z","title":"[리액트 2부] 2.3 라우터 2","series":"[리액트 2부] 고급주제와 훅"}},{"id":"360c5627-4b69-539e-b056-caffd631bee9","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part2-ch4","date":"2023-06-24T00:02:04.000Z","title":"[리액트 2부] 2.4 다이얼로그 1","series":"[리액트 2부] 고급주제와 훅"}},{"id":"2f981235-0d19-5e8e-8309-253da9b4b3ac","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part2-ch5","date":"2023-06-24T00:02:05.000Z","title":"[리액트 2부] 2.5 다이얼로그 2","series":"[리액트 2부] 고급주제와 훅"}},{"id":"1f35fa1b-0a33-5035-b844-efcb0c967688","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part2-ch6","date":"2023-06-24T00:02:06.000Z","title":"[리액트 2부] 2편 최종정리","series":"[리액트 2부] 고급주제와 훅"}},{"id":"0a51e0a1-ff3c-5f75-9b68-fd370827174f","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part3","date":"2023-06-24T00:03:00.000Z","title":"[리액트 2부] 3편 기본훅","series":"[리액트 2부] 고급주제와 훅"}},{"id":"5a1eb2d4-889b-5c99-9741-8a909bb421d2","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part3-ch1","date":"2023-06-24T00:03:01.000Z","title":"[리액트 2부] 3.1 클래스/함수 컴포넌트","series":"[리액트 2부] 고급주제와 훅"}},{"id":"adf0b01d-2fe9-52ea-a660-f99eb6e43a2f","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part3-ch2","date":"2023-06-24T00:03:02.000Z","title":"[리액트 2부] 3.2 상태 훅","series":"[리액트 2부] 고급주제와 훅"}},{"id":"8db42df9-10c7-5d69-a22a-855b8d07a3e3","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part3-ch3","date":"2023-06-24T00:03:03.000Z","title":"[리액트 2부] 3.3 부수효과 훅","series":"[리액트 2부] 고급주제와 훅"}},{"id":"26e4b794-4f27-53e5-b37b-619fd2f3eec1","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part3-ch4","date":"2023-06-24T00:03:04.000Z","title":"[리액트 2부] 3.4 훅 활용 1","series":"[리액트 2부] 고급주제와 훅"}},{"id":"ebb25f92-6395-508c-a520-4ceb2cde3e79","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part3-ch5","date":"2023-06-24T00:03:05.000Z","title":"[리액트 2부] 3.5 컨택스트 훅","series":"[리액트 2부] 고급주제와 훅"}},{"id":"df39246f-a953-5bb8-9b93-e7dce1c1892a","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part3-ch6","date":"2023-06-24T00:03:06.000Z","title":"[리액트 2부] 3.6 훅 활용 2","series":"[리액트 2부] 고급주제와 훅"}},{"id":"3081cea1-8b4f-57ef-a54f-d241e7e106e9","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part3-ch7","date":"2023-06-24T00:03:07.000Z","title":"[리액트 2부] 3편 최종정리","series":"[리액트 2부] 고급주제와 훅"}},{"id":"ff268c7c-b451-560f-8c1a-fff063bbbdd8","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part4","date":"2023-06-24T00:04:00.000Z","title":"[리액트 2부] 4편 추가훅","series":"[리액트 2부] 고급주제와 훅"}},{"id":"28d8ea25-f6ab-53d9-8d8d-681a43e8856c","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part4-ch1","date":"2023-06-24T00:04:01.000Z","title":"[리액트 2부] 4.1 레프 훅","series":"[리액트 2부] 고급주제와 훅"}},{"id":"7cfc7eee-a37e-5f6a-b961-f3df6a405a2d","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part4-ch2","date":"2023-06-24T00:04:02.000Z","title":"[리액트 2부] 4.2 제어 폼","series":"[리액트 2부] 고급주제와 훅"}},{"id":"93c5cdcb-64fc-58a8-bf8e-e50da44a9eee","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part4-ch3","date":"2023-06-24T00:04:03.000Z","title":"[리액트 2부] 4.3 리듀서 훅","series":"[리액트 2부] 고급주제와 훅"}},{"id":"924e27e8-e2bb-5422-92c4-b5b0710eed15","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part4-ch4","date":"2023-06-24T00:04:04.000Z","title":"[리액트 2부] 4.4 메모이제이션 훅","series":"[리액트 2부] 고급주제와 훅"}},{"id":"8ef47dc5-f1d8-5527-9ae0-020099be4140","frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part4-ch5","date":"2023-06-24T00:04:05.000Z","title":"[리액트 2부] 4편 최종정리","series":"[리액트 2부] 고급주제와 훅"}}]}},"pageContext":{"slug":"/2023/06/24/lecture-react-season2-part2-ch1","date":"2023-06-24T00:02:01.000Z","series":"[리액트 2부] 고급주제와 훅","videoId":null,"previous":{"frontmatter":{"slug":"/2023/06/24/lecture-react-season2","date":"2023-06-24T00:02:00.000Z","title":"[리액트 2부] 2편 고급주제","category":null,"series":"[리액트 2부] 고급주제와 훅","videoId":null}},"next":{"frontmatter":{"slug":"/2023/06/24/lecture-react-season2-part2-ch2","date":"2023-06-24T00:02:02.000Z","title":"[리액트 2부] 2.2 라우터 1","category":null,"series":"[리액트 2부] 고급주제와 훅","videoId":null}}}},"staticQueryHashes":["2263867198"]}